"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const s=require("react"),ee=require("react/jsx-runtime"),ue=()=>typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`${Date.now().toString(36)}-${Math.random().toString(36).slice(2,11)}`,de=(...e)=>{const t=[];for(const n of e)if(n){if(typeof n=="string"||typeof n=="number")t.push(String(n));else if(Array.isArray(n)){const r=de(...n);r&&t.push(r)}else if(typeof n=="object")for(const[r,o]of Object.entries(n))o&&t.push(r)}return t.join(" ")};function ve(e,t){const n={...e};for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)){const o=t[r],a=e[r];o!==null&&typeof o=="object"&&!Array.isArray(o)&&a!==null&&typeof a=="object"&&!Array.isArray(a)?n[r]=ve(a,o):o!==void 0&&(n[r]=o)}return n}const St=(e,t)=>{const n=t.x-e.x,r=t.y-e.y;return Math.sqrt(n*n+r*r)},Ct=(e,t)=>e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height,Rt=(e,t)=>!(e.x+e.width<t.x||t.x+t.width<e.x||e.y+e.height<t.y||t.y+t.height<e.y),It=(e,t)=>Math.round(e/t)*t,Xe=(e,t)=>{const{x:n,y:r,width:o,height:a}=e,c=t/2;return[{position:"nw",x:n-c,y:r-c},{position:"n",x:n+o/2-c,y:r-c},{position:"ne",x:n+o-c,y:r-c},{position:"e",x:n+o-c,y:r+a/2-c},{position:"se",x:n+o-c,y:r+a-c},{position:"s",x:n+o/2-c,y:r+a-c},{position:"sw",x:n-c,y:r+a-c},{position:"w",x:n-c,y:r+a/2-c}]},ye=e=>[...e].sort((t,n)=>t.zIndex-n.zIndex),Tt=e=>e.length===0?0:Math.max(...e.map(t=>t.zIndex)),Mt=e=>e.length===0?0:Math.min(...e.map(t=>t.zIndex)),Ye=(e,t)=>{const n=Tt(e);return e.map(r=>r.id===t?{...r,zIndex:n+1}:r)},Ke=(e,t)=>{const n=Mt(e);return e.map(r=>r.id===t?{...r,zIndex:n-1}:r)},zt=(e,t)=>{const n=ye(e),r=n.findIndex(c=>c.id===t);if(r===-1||r===n.length-1)return e;const o=n[r],a=n[r+1];return e.map(c=>c.id===o.id?{...c,zIndex:a.zIndex+1}:c)},Dt=(e,t)=>{const n=ye(e),r=n.findIndex(c=>c.id===t);if(r<=0)return e;const o=n[r],a=n[r-1];return e.map(c=>c.id===o.id?{...c,zIndex:a.zIndex-1}:c)},Ge=e=>{const t=[];if(!e||typeof e!="object")return{valid:!1,errors:["Data must be an object"]};const n=e;return typeof n.version!="string"&&t.push("Missing or invalid version field"),Array.isArray(n.elements)?n.elements.forEach((r,o)=>{const a=Nt(r,o);t.push(...a)}):t.push("Elements must be an array"),Array.isArray(n.connections)?n.connections.forEach((r,o)=>{const a=At(r,o);t.push(...a)}):t.push("Connections must be an array"),{valid:t.length===0,errors:t}},Nt=(e,t)=>{const n=[],r=`Element[${t}]`;if(!e||typeof e!="object")return[`${r}: Must be an object`];const o=e;return(typeof o.id!="string"||o.id.length===0)&&n.push(`${r}: Missing or invalid id`),(typeof o.type!="string"||o.type.length===0)&&n.push(`${r}: Missing or invalid type`),(typeof o.x!="number"||isNaN(o.x))&&n.push(`${r}: Missing or invalid x coordinate`),(typeof o.y!="number"||isNaN(o.y))&&n.push(`${r}: Missing or invalid y coordinate`),(typeof o.width!="number"||isNaN(o.width)||o.width<0)&&n.push(`${r}: Missing or invalid width`),(typeof o.height!="number"||isNaN(o.height)||o.height<0)&&n.push(`${r}: Missing or invalid height`),(typeof o.zIndex!="number"||isNaN(o.zIndex))&&n.push(`${r}: Missing or invalid zIndex`),n},At=(e,t)=>{const n=[],r=`Connection[${t}]`;if(!e||typeof e!="object")return[`${r}: Must be an object`];const o=e;return(typeof o.id!="string"||o.id.length===0)&&n.push(`${r}: Missing or invalid id`),(typeof o.fromId!="string"||o.fromId.length===0)&&n.push(`${r}: Missing or invalid fromId`),(typeof o.toId!="string"||o.toId.length===0)&&n.push(`${r}: Missing or invalid toId`),n},Lt="1.0.0",Ot=(e,t,n)=>JSON.stringify({version:Lt,elements:e,connections:t,metadata:n},null,2),Je=e=>{const t=JSON.parse(e),n=Ge(t);if(!n.valid)throw new Error(`Invalid canvas data: ${n.errors.join(", ")}`);return t},_t=(e,t)=>{const n=e.cloneNode(!0);if(n.getAttribute("xmlns")||n.setAttribute("xmlns","http://www.w3.org/2000/svg"),t?.includeStyles){const o=document.createElement("style");o.textContent=qe(e),n.insertBefore(o,n.firstChild)}return new XMLSerializer().serializeToString(n)},qe=e=>{const t=new Set;return e.querySelectorAll("*").forEach(n=>t.add(n.tagName.toLowerCase())),`
    svg { font-family: system-ui, sans-serif; }
    text { user-select: none; }
  `},Pt=(e,t,n)=>{const r=new Blob([e],{type:n}),o=URL.createObjectURL(r),a=document.createElement("a");a.href=o,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o)},we=async(e,t={})=>{const{format:n="png",quality:r=.92,backgroundColor:o,scale:a=1}=t,c=e.getBoundingClientRect(),u=c.width*a,m=c.height*a,f=e.cloneNode(!0);f.setAttribute("xmlns","http://www.w3.org/2000/svg"),f.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");const h=document.createElementNS("http://www.w3.org/2000/svg","style");h.textContent=qe(e),f.insertBefore(h,f.firstChild);const w=new XMLSerializer().serializeToString(f),x=new Blob([w],{type:"image/svg+xml;charset=utf-8"}),g=URL.createObjectURL(x);return new Promise((i,b)=>{const E=new Image;E.onload=()=>{const l=document.createElement("canvas");l.width=u,l.height=m;const S=l.getContext("2d");if(!S){URL.revokeObjectURL(g),b(new Error("Failed to get canvas context"));return}const d=o??(n==="jpeg"?"#ffffff":"transparent");d!=="transparent"&&(S.fillStyle=d,S.fillRect(0,0,u,m)),S.scale(a,a),S.drawImage(E,0,0),l.toBlob(y=>{URL.revokeObjectURL(g),y?i(y):b(new Error("Failed to create image blob"))},n==="jpeg"?"image/jpeg":"image/png",n==="jpeg"?r:void 0)},E.onerror=()=>{URL.revokeObjectURL(g),b(new Error("Failed to load SVG as image"))},E.src=g})},Bt=async(e,t,n={})=>{const{format:r="png"}=n,o=await we(e,n),a=URL.createObjectURL(o),c=document.createElement("a");c.href=a,c.download=`${t}.${r}`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(a)},oe={name:"light",colors:{background:"#ffffff",surface:"#f8f9fa",border:"#dee2e6",text:{primary:"#212529",secondary:"#6c757d",disabled:"#adb5bd"},selection:{fill:"rgba(59, 130, 246, 0.1)",stroke:"#3b82f6"},element:{fill:"#ffffff",stroke:"#212529",hover:"#f1f5f9",active:"#e2e8f0"},handle:{fill:"#ffffff",stroke:"#3b82f6"},grid:{line:"#e5e7eb",dot:"#d1d5db"},connection:{line:"#64748b",arrow:"#64748b"}},spacing:{xs:4,sm:8,md:16,lg:24,xl:32},borderRadius:{sm:2,md:4,lg:8},fontSize:{xs:10,sm:12,md:14,lg:16,xl:20},strokeWidth:{thin:1,normal:2,thick:3},shadows:{sm:"0 1px 2px rgba(0,0,0,0.05)",md:"0 4px 6px rgba(0,0,0,0.1)",lg:"0 10px 15px rgba(0,0,0,0.1)",element:"0 2px 4px rgba(0,0,0,0.1)",handle:"0 1px 2px rgba(0,0,0,0.1)"}},Qe={name:"dark",colors:{background:"#1e1e1e",surface:"#252526",border:"#3c3c3c",text:{primary:"#ffffff",secondary:"#a0a0a0",disabled:"#5a5a5a"},selection:{fill:"rgba(59, 130, 246, 0.2)",stroke:"#60a5fa"},element:{fill:"#2d2d2d",stroke:"#ffffff",hover:"#383838",active:"#454545"},handle:{fill:"#2d2d2d",stroke:"#60a5fa"},grid:{line:"#333333",dot:"#444444"},connection:{line:"#94a3b8",arrow:"#94a3b8"}},spacing:oe.spacing,borderRadius:oe.borderRadius,fontSize:oe.fontSize,strokeWidth:oe.strokeWidth,shadows:{sm:"0 1px 2px rgba(0,0,0,0.3)",md:"0 4px 6px rgba(0,0,0,0.4)",lg:"0 10px 15px rgba(0,0,0,0.5)",element:"0 2px 4px rgba(0,0,0,0.3)",handle:"0 1px 2px rgba(0,0,0,0.3)"}},et=s.createContext({theme:oe,themeName:"light"}),q=()=>{const e=s.useContext(et);if(!e)throw new Error("useTheme must be used within a ThemeProvider");return e},tt=({children:e,theme:t="light"})=>{const n=s.useMemo(()=>t==="light"?{theme:oe,themeName:"light"}:t==="dark"?{theme:Qe,themeName:"dark"}:{theme:ve(oe,t),themeName:"custom"},[t]);return s.createElement(et.Provider,{value:n},e)},$t=e=>({"--canvas-bg":e.colors.background,"--canvas-surface":e.colors.surface,"--canvas-border":e.colors.border,"--canvas-text-primary":e.colors.text.primary,"--canvas-text-secondary":e.colors.text.secondary,"--canvas-text-disabled":e.colors.text.disabled,"--canvas-selection-fill":e.colors.selection.fill,"--canvas-selection-stroke":e.colors.selection.stroke,"--canvas-element-fill":e.colors.element.fill,"--canvas-element-stroke":e.colors.element.stroke,"--canvas-element-hover":e.colors.element.hover,"--canvas-element-active":e.colors.element.active,"--canvas-handle-fill":e.colors.handle.fill,"--canvas-handle-stroke":e.colors.handle.stroke,"--canvas-grid-line":e.colors.grid.line,"--canvas-grid-dot":e.colors.grid.dot,"--canvas-connection-line":e.colors.connection.line,"--canvas-connection-arrow":e.colors.connection.arrow,"--canvas-spacing-xs":`${e.spacing.xs}px`,"--canvas-spacing-sm":`${e.spacing.sm}px`,"--canvas-spacing-md":`${e.spacing.md}px`,"--canvas-spacing-lg":`${e.spacing.lg}px`,"--canvas-spacing-xl":`${e.spacing.xl}px`,"--canvas-radius-sm":`${e.borderRadius.sm}px`,"--canvas-radius-md":`${e.borderRadius.md}px`,"--canvas-radius-lg":`${e.borderRadius.lg}px`,"--canvas-font-xs":`${e.fontSize.xs}px`,"--canvas-font-sm":`${e.fontSize.sm}px`,"--canvas-font-md":`${e.fontSize.md}px`,"--canvas-font-lg":`${e.fontSize.lg}px`,"--canvas-font-xl":`${e.fontSize.xl}px`,"--canvas-stroke-thin":`${e.strokeWidth.thin}px`,"--canvas-stroke-normal":`${e.strokeWidth.normal}px`,"--canvas-stroke-thick":`${e.strokeWidth.thick}px`,"--canvas-shadow-sm":e.shadows.sm,"--canvas-shadow-md":e.shadows.md,"--canvas-shadow-lg":e.shadows.lg,"--canvas-shadow-element":e.shadows.element,"--canvas-shadow-handle":e.shadows.handle}),nt={zoom:1,pan:{x:0,y:0},minZoom:.1,maxZoom:5},Wt=(e,t)=>{switch(t.type){case"SET_ZOOM":{const n=Math.max(e.minZoom,Math.min(e.maxZoom,t.payload));return{...e,zoom:n}}case"ZOOM_IN":{const n=Math.min(e.maxZoom,e.zoom*1.2);return{...e,zoom:n}}case"ZOOM_OUT":{const n=Math.max(e.minZoom,e.zoom/1.2);return{...e,zoom:n}}case"ZOOM_TO_FIT":{const{bounds:n,padding:r=50}=t.payload,o=Math.max(e.minZoom,Math.min(e.maxZoom,1)),a={x:-(n.x-r),y:-(n.y-r)};return{...e,zoom:o,pan:a}}case"SET_PAN":return{...e,pan:t.payload};case"PAN_BY":return{...e,pan:{x:e.pan.x+t.payload.x,y:e.pan.y+t.payload.y}};case"RESET":return{...nt,minZoom:e.minZoom,maxZoom:e.maxZoom};case"SET_CONSTRAINTS":return{...e,minZoom:t.payload.minZoom??e.minZoom,maxZoom:t.payload.maxZoom??e.maxZoom};default:return e}},st=s.createContext(null),ae=()=>{const e=s.useContext(st);if(!e)throw new Error("useViewport must be used within a ViewportProvider");return e},ot=({children:e,initialViewport:t})=>{const[n,r]=s.useReducer(Wt,{...nt,...t}),o=s.useCallback(i=>{r({type:"SET_ZOOM",payload:i})},[]),a=s.useCallback(()=>{r({type:"ZOOM_IN"})},[]),c=s.useCallback(()=>{r({type:"ZOOM_OUT"})},[]),u=s.useCallback((i,b)=>{r({type:"ZOOM_TO_FIT",payload:{bounds:i,padding:b}})},[]),m=s.useCallback(i=>{r({type:"SET_PAN",payload:i})},[]),f=s.useCallback(i=>{r({type:"PAN_BY",payload:i})},[]),h=s.useCallback(()=>{r({type:"RESET"})},[]),v=s.useCallback(i=>{r({type:"SET_CONSTRAINTS",payload:i})},[]),w=s.useCallback(i=>({x:(i.x-n.pan.x)/n.zoom,y:(i.y-n.pan.y)/n.zoom}),[n.zoom,n.pan]),x=s.useCallback(i=>({x:i.x*n.zoom+n.pan.x,y:i.y*n.zoom+n.pan.y}),[n.zoom,n.pan]),g=s.useMemo(()=>({viewport:n,setZoom:o,zoomIn:a,zoomOut:c,zoomToFit:u,setPan:m,panBy:f,resetViewport:h,setConstraints:v,screenToCanvas:w,canvasToScreen:x}),[n,o,a,c,u,m,f,h,v,w,x]);return s.createElement(st.Provider,{value:g},e)},Ut={selectedIds:new Set,lastSelectedId:null},Zt=(e,t)=>{switch(t.type){case"SELECT":return{selectedIds:new Set([t.payload]),lastSelectedId:t.payload};case"SELECT_MULTIPLE":return{selectedIds:new Set(t.payload),lastSelectedId:t.payload.length>0?t.payload[t.payload.length-1]:null};case"ADD_TO_SELECTION":{const n=new Set(e.selectedIds);return n.add(t.payload),{selectedIds:n,lastSelectedId:t.payload}}case"REMOVE_FROM_SELECTION":{const n=new Set(e.selectedIds);return n.delete(t.payload),{selectedIds:n,lastSelectedId:n.size>0?Array.from(n).pop():null}}case"TOGGLE_SELECTION":{const n=new Set(e.selectedIds);return n.has(t.payload)?(n.delete(t.payload),{selectedIds:n,lastSelectedId:n.size>0?Array.from(n).pop():null}):(n.add(t.payload),{selectedIds:n,lastSelectedId:t.payload})}case"CLEAR_SELECTION":return Ut;case"SELECT_ALL":return{selectedIds:new Set(t.payload),lastSelectedId:t.payload.length>0?t.payload[t.payload.length-1]:null};default:return e}},rt=s.createContext(null),he=()=>{const e=s.useContext(rt);if(!e)throw new Error("useSelection must be used within a SelectionProvider");return e},at=({children:e,initialSelection:t,onSelectionChange:n})=>{const[r,o]=s.useReducer(Zt,{selectedIds:new Set(t??[]),lastSelectedId:t?.[t.length-1]??null}),a=s.useMemo(()=>Array.from(r.selectedIds),[r.selectedIds]);s.useEffect(()=>{n?.(a)},[a,n]);const c=s.useCallback(i=>r.selectedIds.has(i),[r.selectedIds]),u=s.useCallback(i=>{o({type:"SELECT",payload:i})},[]),m=s.useCallback(i=>{o({type:"SELECT_MULTIPLE",payload:i})},[]),f=s.useCallback(i=>{o({type:"ADD_TO_SELECTION",payload:i})},[]),h=s.useCallback(i=>{o({type:"REMOVE_FROM_SELECTION",payload:i})},[]),v=s.useCallback(i=>{o({type:"TOGGLE_SELECTION",payload:i})},[]),w=s.useCallback(()=>{o({type:"CLEAR_SELECTION"})},[]),x=s.useCallback(i=>{o({type:"SELECT_ALL",payload:i})},[]),g=s.useMemo(()=>({selectedIds:a,lastSelectedId:r.lastSelectedId,selectionCount:r.selectedIds.size,hasSelection:r.selectedIds.size>0,isSelected:c,select:u,selectMultiple:m,addToSelection:f,removeFromSelection:h,toggleSelection:v,clearSelection:w,selectAll:x}),[a,r.lastSelectedId,r.selectedIds.size,c,u,m,f,h,v,w,x]);return s.createElement(rt.Provider,{value:g},e)},jt=(e,t)=>{switch(t.type){case"PUSH":{const n=[...e.past,e.present];return n.length>e.maxHistorySize&&n.shift(),{...e,past:n,present:t.payload,future:[]}}case"UNDO":{if(e.past.length===0)return e;const n=e.past[e.past.length-1],r=e.past.slice(0,-1);return{...e,past:r,present:n,future:[e.present,...e.future]}}case"REDO":{if(e.future.length===0)return e;const n=e.future[0],r=e.future.slice(1);return{...e,past:[...e.past,e.present],present:n,future:r}}case"CLEAR":return{...e,past:[],present:e.present,future:[]};case"SET_PRESENT":return{...e,present:t.payload};case"SET_MAX_SIZE":return{...e,maxHistorySize:t.payload};default:return e}},ct=s.createContext(null),lt=()=>{const e=s.useContext(ct);if(!e)throw new Error("useHistory must be used within a HistoryProvider");return e},it=({children:e,initialElements:t=[],initialConnections:n=[],maxHistorySize:r=50,onStateChange:o})=>{const[a,c]=s.useReducer(jt,{past:[],present:{elements:t,connections:n,timestamp:Date.now()},future:[],maxHistorySize:r});s.useEffect(()=>{o?.(a.present.elements,a.present.connections)},[a.present,o]);const u=s.useCallback((g,i)=>{c({type:"PUSH",payload:{elements:g,connections:i,timestamp:Date.now()}})},[]),m=s.useCallback(()=>{c({type:"UNDO"})},[]),f=s.useCallback(()=>{c({type:"REDO"})},[]),h=s.useCallback(()=>{c({type:"CLEAR"})},[]),v=s.useCallback((g,i)=>{c({type:"SET_PRESENT",payload:{elements:g,connections:i,timestamp:Date.now()}})},[]),w=s.useCallback(g=>{c({type:"SET_MAX_SIZE",payload:g})},[]),x=s.useMemo(()=>({canUndo:a.past.length>0,canRedo:a.future.length>0,historySize:a.past.length,futureSize:a.future.length,present:a.present,pushState:u,undo:m,redo:f,clearHistory:h,setPresent:v,setMaxHistorySize:w}),[a.past.length,a.future.length,a.present,u,m,f,h,v,w]);return s.createElement(ct.Provider,{value:x},e)},Ht={width:800,height:600,grid:{enabled:!1,size:20,snap:!1,visible:!1},readonly:!1},Vt=(e,t)=>{switch(t.type){case"ADD_ELEMENT":return{...e,elements:[...e.elements,t.payload]};case"ADD_ELEMENTS":return{...e,elements:[...e.elements,...t.payload]};case"UPDATE_ELEMENT":return{...e,elements:e.elements.map(n=>n.id===t.payload.id?{...n,...t.payload.updates}:n)};case"UPDATE_ELEMENTS":return{...e,elements:e.elements.map(n=>t.payload.ids.includes(n.id)?{...n,...t.payload.updates}:n)};case"REMOVE_ELEMENT":{const n=t.payload;return{...e,elements:e.elements.filter(r=>r.id!==n),connections:e.connections.filter(r=>r.fromId!==n&&r.toId!==n)}}case"REMOVE_ELEMENTS":{const n=new Set(t.payload);return{...e,elements:e.elements.filter(r=>!n.has(r.id)),connections:e.connections.filter(r=>!n.has(r.fromId)&&!n.has(r.toId))}}case"MOVE_ELEMENT":return{...e,elements:e.elements.map(n=>n.id===t.payload.id?{...n,x:t.payload.x,y:t.payload.y}:n)};case"MOVE_ELEMENTS":return{...e,elements:e.elements.map(n=>t.payload.ids.includes(n.id)?{...n,x:n.x+t.payload.deltaX,y:n.y+t.payload.deltaY}:n)};case"RESIZE_ELEMENT":return{...e,elements:e.elements.map(n=>n.id===t.payload.id?{...n,width:t.payload.width,height:t.payload.height,...t.payload.x!==void 0&&{x:t.payload.x},...t.payload.y!==void 0&&{y:t.payload.y}}:n)};case"BRING_TO_FRONT":return{...e,elements:Ye(e.elements,t.payload)};case"SEND_TO_BACK":return{...e,elements:Ke(e.elements,t.payload)};case"MOVE_UP":return{...e,elements:zt(e.elements,t.payload)};case"MOVE_DOWN":return{...e,elements:Dt(e.elements,t.payload)};case"SET_ELEMENTS":return{...e,elements:t.payload};case"ADD_CONNECTION":return{...e,connections:[...e.connections,t.payload]};case"UPDATE_CONNECTION":return{...e,connections:e.connections.map(n=>n.id===t.payload.id?{...n,...t.payload.updates}:n)};case"REMOVE_CONNECTION":return{...e,connections:e.connections.filter(n=>n.id!==t.payload)};case"SET_CONNECTIONS":return{...e,connections:t.payload};case"UPDATE_CONFIG":return{...e,config:{...e.config,...t.payload}};case"CLEAR_CANVAS":return{...e,elements:[],connections:[]};case"LOAD_STATE":return{...e,elements:t.payload.elements,connections:t.payload.connections};default:return e}},dt=s.createContext(null),ce=()=>{const e=s.useContext(dt);if(!e)throw new Error("useCanvas must be used within a CanvasProvider");return e},ut=({children:e,initialElements:t=[],initialConnections:n=[],config:r,onChange:o})=>{const[a,c]=s.useReducer(Vt,{elements:t,connections:n,config:{...Ht,...r}});s.useEffect(()=>{o?.(a.elements,a.connections)},[a.elements,a.connections,o]);const u=s.useCallback(p=>a.elements.find(R=>R.id===p),[a.elements]),m=s.useCallback(p=>a.elements.filter(R=>R.type===p),[a.elements]),f=s.useCallback(p=>{const R=p.id??ue(),O=a.elements.length>0?Math.max(...a.elements.map(U=>U.zIndex)):0;return c({type:"ADD_ELEMENT",payload:{...p,id:R,zIndex:p.zIndex??O+1}}),R},[a.elements]),h=s.useCallback(p=>{const R=a.elements.length>0?Math.max(...a.elements.map(U=>U.zIndex)):0,O=p.map((U,Y)=>({...U,id:U.id??ue(),zIndex:U.zIndex??R+1+Y}));return c({type:"ADD_ELEMENTS",payload:O}),O.map(U=>U.id)},[a.elements]),v=s.useCallback((p,R)=>{c({type:"UPDATE_ELEMENT",payload:{id:p,updates:R}})},[]),w=s.useCallback((p,R)=>{c({type:"UPDATE_ELEMENTS",payload:{ids:p,updates:R}})},[]),x=s.useCallback(p=>{c({type:"REMOVE_ELEMENT",payload:p})},[]),g=s.useCallback(p=>{c({type:"REMOVE_ELEMENTS",payload:p})},[]),i=s.useCallback((p,R,O)=>{c({type:"MOVE_ELEMENT",payload:{id:p,x:R,y:O}})},[]),b=s.useCallback((p,R,O)=>{c({type:"MOVE_ELEMENTS",payload:{ids:p,deltaX:R,deltaY:O}})},[]),E=s.useCallback((p,R,O,U,Y)=>{c({type:"RESIZE_ELEMENT",payload:{id:p,width:R,height:O,x:U,y:Y}})},[]),l=s.useCallback(p=>{c({type:"BRING_TO_FRONT",payload:p})},[]),S=s.useCallback(p=>{c({type:"SEND_TO_BACK",payload:p})},[]),d=s.useCallback(p=>{c({type:"MOVE_UP",payload:p})},[]),y=s.useCallback(p=>{c({type:"MOVE_DOWN",payload:p})},[]),k=s.useCallback(p=>{c({type:"SET_ELEMENTS",payload:p})},[]),C=s.useCallback(p=>a.connections.find(R=>R.id===p),[a.connections]),M=s.useCallback(p=>a.connections.filter(R=>R.fromId===p||R.toId===p),[a.connections]),T=s.useCallback(p=>{const R=p.id??ue();return c({type:"ADD_CONNECTION",payload:{...p,id:R}}),R},[]),B=s.useCallback((p,R)=>{c({type:"UPDATE_CONNECTION",payload:{id:p,updates:R}})},[]),P=s.useCallback(p=>{c({type:"REMOVE_CONNECTION",payload:p})},[]),A=s.useCallback(p=>{c({type:"SET_CONNECTIONS",payload:p})},[]),L=s.useCallback(p=>{c({type:"UPDATE_CONFIG",payload:p})},[]),$=s.useCallback(()=>{c({type:"CLEAR_CANVAS"})},[]),H=s.useCallback((p,R)=>{c({type:"LOAD_STATE",payload:{elements:p,connections:R}})},[]),V=s.useMemo(()=>({elements:a.elements,connections:a.connections,config:a.config,getElementById:u,getElementsByType:m,addElement:f,addElements:h,updateElement:v,updateElements:w,removeElement:x,removeElements:g,moveElement:i,moveElements:b,resizeElement:E,bringToFront:l,sendToBack:S,moveUp:d,moveDown:y,setElements:k,getConnectionById:C,getConnectionsForElement:M,addConnection:T,updateConnection:B,removeConnection:P,setConnections:A,updateConfig:L,clearCanvas:$,loadState:H}),[a.elements,a.connections,a.config,u,m,f,h,v,w,x,g,i,b,E,l,S,d,y,k,C,M,T,B,P,A,L,$,H]);return s.createElement(dt.Provider,{value:V},e)},ht=({children:e,initialElements:t=[],initialConnections:n=[],config:r,theme:o="light",initialViewport:a,maxHistorySize:c=50,onElementsChange:u,onSelectionChange:m,elements:f,connections:h,selectedIds:v})=>{const w=f??t,x=h??n;return ee.jsx(tt,{theme:o,children:ee.jsx(ot,{initialViewport:a,children:ee.jsx(at,{initialSelection:v,onSelectionChange:m,children:ee.jsx(it,{initialElements:w,initialConnections:x,maxHistorySize:c,children:ee.jsx(ut,{initialElements:w,initialConnections:x,config:r,onChange:u,children:e})})})})})},ke=(e={})=>{const{onDragStart:t,onDrag:n,onDragEnd:r,disabled:o=!1,threshold:a=3}=e,[c,u]=s.useState({isDragging:!1,startPosition:null,currentPosition:null,delta:{x:0,y:0}}),m=s.useRef(null),f=s.useRef(!1),{screenToCanvas:h}=ae(),v=s.useCallback(E=>{if("touches"in E){const l=E.touches[0]||E.changedTouches[0];return h({x:l.clientX,y:l.clientY})}return h({x:E.clientX,y:E.clientY})},[h]),w=s.useCallback(E=>{if(!m.current)return;const l=v(E),S={x:l.x-m.current.x,y:l.y-m.current.y};if(!f.current){if(Math.sqrt(S.x**2+S.y**2)<a)return;f.current=!0,t?.(m.current)}u({isDragging:!0,startPosition:m.current,currentPosition:l,delta:S}),n?.(l,S)},[v,a,t,n]),x=s.useCallback(E=>{if(!m.current)return;const l=v(E),S={x:l.x-m.current.x,y:l.y-m.current.y};f.current&&r?.(l,S),u({isDragging:!1,startPosition:null,currentPosition:null,delta:{x:0,y:0}}),m.current=null,f.current=!1,document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",x),document.removeEventListener("touchmove",w),document.removeEventListener("touchend",x)},[v,w,r]),g=s.useCallback((E,l)=>{if(o)return;const S=h({x:E,y:l});m.current=S,f.current=!1,u({isDragging:!1,startPosition:S,currentPosition:S,delta:{x:0,y:0}}),document.addEventListener("mousemove",w),document.addEventListener("mouseup",x),document.addEventListener("touchmove",w,{passive:!1}),document.addEventListener("touchend",x)},[o,h,w,x]),i=s.useCallback(E=>{E.button===0&&(E.preventDefault(),E.stopPropagation(),g(E.clientX,E.clientY))},[g]),b=s.useCallback(E=>{if(E.touches.length!==1)return;const l=E.touches[0];g(l.clientX,l.clientY)},[g]);return{dragState:c,handlers:{onMouseDown:i,onTouchStart:b},isDragging:c.isDragging}},mt=(e={})=>{const{onResizeStart:t,onResize:n,onResizeEnd:r,disabled:o=!1,minWidth:a=20,minHeight:c=20,maxWidth:u=1/0,maxHeight:m=1/0,maintainAspectRatio:f=!1,aspectRatio:h}=e,[v,w]=s.useState({isResizing:!1,handle:null,startBounds:null,currentBounds:null}),x=s.useRef(null),{screenToCanvas:g}=ae(),i=s.useCallback(d=>{if("touches"in d){const y=d.touches[0]||d.changedTouches[0];return g({x:y.clientX,y:y.clientY})}return g({x:d.clientX,y:d.clientY})},[g]),b=s.useCallback(d=>{if(!x.current)return{x:0,y:0,width:0,height:0};const{position:y,bounds:k,handle:C}=x.current,M=d.x-y.x,T=d.y-y.y;let B=k.x,P=k.y,A=k.width,L=k.height;switch(C){case"nw":B=k.x+M,P=k.y+T,A=k.width-M,L=k.height-T;break;case"n":P=k.y+T,L=k.height-T;break;case"ne":P=k.y+T,A=k.width+M,L=k.height-T;break;case"e":A=k.width+M;break;case"se":A=k.width+M,L=k.height+T;break;case"s":L=k.height+T;break;case"sw":B=k.x+M,A=k.width-M,L=k.height+T;break;case"w":B=k.x+M,A=k.width-M;break}if(A<a&&(C.includes("w")&&(B=k.x+k.width-a),A=a),L<c&&(C.includes("n")&&(P=k.y+k.height-c),L=c),A>u&&(A=u),L>m&&(L=m),f&&x.current.aspectRatio){const $=x.current.aspectRatio;A/L>$?A=L*$:L=A/$}return{x:B,y:P,width:A,height:L}},[a,c,u,m,f]),E=s.useCallback(d=>{if(!x.current)return;const y=i(d),k=b(y);w(C=>({...C,currentBounds:k})),n?.(k)},[i,b,n]),l=s.useCallback(d=>{if(!x.current)return;const y=i(d),k=b(y);r?.(k),w({isResizing:!1,handle:null,startBounds:null,currentBounds:null}),x.current=null,document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",l),document.removeEventListener("touchmove",E),document.removeEventListener("touchend",l)},[i,b,E,r]),S=s.useCallback((d,y,k)=>{if(o)return;k.preventDefault(),k.stopPropagation();const C="touches"in k?k.touches[0].clientX:k.clientX,M="touches"in k?k.touches[0].clientY:k.clientY,T=g({x:C,y:M});x.current={position:T,bounds:y,handle:d,aspectRatio:h??y.width/y.height},w({isResizing:!0,handle:d,startBounds:y,currentBounds:y}),t?.(d),document.addEventListener("mousemove",E),document.addEventListener("mouseup",l),document.addEventListener("touchmove",E,{passive:!1}),document.addEventListener("touchend",l)},[o,g,h,t,E,l]);return{resizeState:v,startResize:S,isResizing:v.isResizing}},be=(e={})=>{const{onRotateStart:t,onRotate:n,onRotateEnd:r,disabled:o=!1,snapAngle:a}=e,[c,u]=s.useState({isRotating:!1,startAngle:null,currentAngle:null,deltaAngle:0}),m=s.useRef(null),{screenToCanvas:f}=ae(),h=s.useCallback(b=>{if("touches"in b){const E=b.touches[0]||b.changedTouches[0];return f({x:E.clientX,y:E.clientY})}return f({x:b.clientX,y:b.clientY})},[f]),v=s.useCallback((b,E)=>{const l=E.x-b.x,S=E.y-b.y;return Math.atan2(S,l)*(180/Math.PI)},[]),w=s.useCallback(b=>a?Math.round(b/a)*a:b,[a]),x=s.useCallback(b=>{if(!m.current||o)return;const E=h(b),{center:l,startMouseAngle:S,initialRotation:d}=m.current;let k=v(l,E)-S,C=d+k;C=(C%360+360)%360,b.shiftKey&&a&&(C=w(C)),u({isRotating:!0,startAngle:d,currentAngle:C,deltaAngle:C-d}),n?.(C,C-d)},[o,h,v,a,w,n]),g=s.useCallback(b=>{if(!m.current)return;const E=h(b),{center:l,startMouseAngle:S,initialRotation:d}=m.current;let k=v(l,E)-S,C=d+k;C=(C%360+360)%360,b.shiftKey&&a&&(C=w(C)),r?.(C),u({isRotating:!1,startAngle:null,currentAngle:null,deltaAngle:0}),m.current=null,document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",g),document.removeEventListener("touchmove",x),document.removeEventListener("touchend",g)},[h,v,a,w,r,x]),i=s.useCallback((b,E,l)=>{if(o)return;l.stopPropagation(),l.preventDefault();const S=h(l.nativeEvent),d=v(b,S);m.current={center:b,startMouseAngle:d,initialRotation:E},u({isRotating:!0,startAngle:E,currentAngle:E,deltaAngle:0}),t?.(E),document.addEventListener("mousemove",x),document.addEventListener("mouseup",g),document.addEventListener("touchmove",x),document.addEventListener("touchend",g)},[o,h,v,t,x,g]);return{rotateState:c,startRotate:i,isRotating:c.isRotating}},Se=e=>{const{id:t,disabled:n=!1,onSelect:r}=e,{isSelected:o,select:a,addToSelection:c,removeFromSelection:u,toggleSelection:m,clearSelection:f}=he(),h=o(t),v=s.useCallback(()=>{n||(a(t),r?.(!0))},[n,t,a,r]),w=s.useCallback(()=>{n||(u(t),r?.(!1))},[n,t,u,r]),x=s.useCallback(()=>{if(n)return;const i=!h;m(t),r?.(i)},[n,t,h,m,r]),g=s.useCallback(i=>{n||(i.stopPropagation(),i.ctrlKey||i.metaKey?(m(t),r?.(!h)):i.shiftKey?(c(t),r?.(!0)):(a(t),r?.(!0)))},[n,t,h,m,c,a,r]);return{isSelected:h,handlers:{onClick:g},select:v,deselect:w,toggle:x}},Ft=(e,t)=>{const n=e.key.toLowerCase()===t.key.toLowerCase();t.ctrl?e.ctrlKey:!e.ctrlKey||t.meta,t.meta?e.metaKey:!e.metaKey||t.ctrl;const r=t.shift?e.shiftKey:!e.shiftKey,o=t.alt?e.altKey:!e.altKey,a=t.ctrl||t.meta?!!(t.ctrl&&(e.ctrlKey||e.metaKey))||!!(t.meta&&e.metaKey):!e.ctrlKey&&!e.metaKey;return n&&a&&r&&o},pt=(e={})=>{const{shortcuts:t=[],enabled:n=!0,targetRef:r}=e,o=s.useRef(t);o.current=t;const a=s.useCallback(c=>{if(n){for(const u of o.current)if(Ft(c,u)){u.preventDefault!==!1&&c.preventDefault(),u.action();return}}},[n]);s.useEffect(()=>{const c=r?.current??document;return c.addEventListener("keydown",a),()=>{c.removeEventListener("keydown",a)}},[a,r])},yt=e=>{const t=[];e.undo&&t.push({key:"z",ctrl:!0,action:e.undo}),e.redo&&(t.push({key:"z",ctrl:!0,shift:!0,action:e.redo}),t.push({key:"y",ctrl:!0,action:e.redo})),e.delete&&(t.push({key:"Delete",action:e.delete}),t.push({key:"Backspace",action:e.delete})),e.selectAll&&t.push({key:"a",ctrl:!0,action:e.selectAll}),e.copy&&t.push({key:"c",ctrl:!0,action:e.copy}),e.paste&&t.push({key:"v",ctrl:!0,action:e.paste}),e.cut&&t.push({key:"x",ctrl:!0,action:e.cut}),e.escape&&t.push({key:"Escape",action:e.escape}),e.zoomIn&&(t.push({key:"+",ctrl:!0,action:e.zoomIn}),t.push({key:"=",ctrl:!0,action:e.zoomIn})),e.zoomOut&&t.push({key:"-",ctrl:!0,action:e.zoomOut}),e.resetZoom&&t.push({key:"0",ctrl:!0,action:e.resetZoom}),pt({shortcuts:t})},gt=()=>{const e=ce(),t=he(),n=lt(),r=s.useRef(null),o=s.useCallback(()=>{n.pushState(e.elements,e.connections)},[n,e.elements,e.connections]),a=s.useCallback(l=>(o(),e.addElement(l)),[e,o]),c=s.useCallback((l,S)=>{o(),e.updateElement(l,S)},[e,o]),u=s.useCallback(l=>{o(),e.removeElement(l)},[e,o]),m=s.useCallback(()=>{t.selectedIds.length!==0&&(o(),e.removeElements(t.selectedIds),t.clearSelection())},[e,t,o]),f=s.useCallback((l,S)=>{t.selectedIds.length!==0&&(o(),e.moveElements(t.selectedIds,l,S))},[e,t,o]),h=s.useCallback(()=>{if(t.selectedIds.length===0)return[];o();const S=e.elements.filter(y=>t.selectedIds.includes(y.id)).map(y=>({...y,id:void 0,x:y.x+20,y:y.y+20})),d=e.addElements(S);return t.selectMultiple(d),d},[e,t,o]),v=s.useCallback(l=>(o(),e.addConnection(l)),[e,o]),w=s.useCallback(l=>{o(),e.removeConnection(l)},[e,o]),x=s.useCallback(()=>{if(t.selectedIds.length===0)return;const l=e.elements.filter(y=>t.selectedIds.includes(y.id)),S=new Set(t.selectedIds),d=e.connections.filter(y=>S.has(y.fromId)&&S.has(y.toId));r.current={elements:l,connections:d}},[e.elements,e.connections,t.selectedIds]),g=s.useCallback(()=>{x(),m()},[x,m]),i=s.useCallback(()=>{if(!r.current)return;o();const l=new Map,S=r.current.elements.map(y=>({...y,id:void 0,x:y.x+20,y:y.y+20})),d=e.addElements(S);r.current.elements.forEach((y,k)=>{l.set(y.id,d[k])}),r.current.connections.forEach(y=>{const k=l.get(y.fromId),C=l.get(y.toId);k&&C&&e.addConnection({...y,id:void 0,fromId:k,toId:C})}),t.selectMultiple(d)},[e,t,o]),b=s.useCallback(()=>{n.canUndo&&(n.undo(),e.loadState(n.present.elements,n.present.connections))},[n,e]),E=s.useCallback(()=>{n.canRedo&&(n.redo(),e.loadState(n.present.elements,n.present.connections))},[n,e]);return{addElement:a,updateElement:c,removeElement:u,removeSelected:m,moveSelected:f,duplicateSelected:h,addConnection:v,removeConnection:w,copy:x,cut:g,paste:i,hasCopied:r.current!==null,undo:b,redo:E,canUndo:n.canUndo,canRedo:n.canRedo}},me=8,ge=s.forwardRef(({element:e,children:t,className:n,style:r,disabled:o=!1,showHandles:a=!0,enableRotation:c=!0,onSelect:u,onDragStart:m,onDrag:f,onDragEnd:h,onResizeStart:v,onResize:w,onResizeEnd:x,onRotateStart:g,onRotate:i,onRotateEnd:b},E)=>{const{updateElement:l}=ce(),{theme:S}=q(),d=e.locked||o,{isSelected:y,handlers:k}=Se({id:e.id,disabled:d,onSelect:u}),{isDragging:C,dragState:M,handlers:T}=ke({disabled:d||!y,onDragStart:()=>{m?.()},onDrag:(z,D)=>{const I=e.x+D.x,N=e.y+D.y;f?.(I,N)},onDragEnd:(z,D)=>{const I=e.x+D.x,N=e.y+D.y;l(e.id,{x:I,y:N}),h?.(I,N)}}),{isResizing:B,resizeState:P,startResize:A}=mt({disabled:d||!y,minWidth:e.minWidth??20,minHeight:e.minHeight??20,maxWidth:e.maxWidth,maxHeight:e.maxHeight,onResizeStart:()=>{v?.()},onResize:z=>{w?.(z.width,z.height,z.x,z.y)},onResizeEnd:z=>{l(e.id,{x:z.x,y:z.y,width:z.width,height:z.height}),x?.(z.width,z.height,z.x,z.y)}}),{isRotating:L,rotateState:$,startRotate:H}=be({disabled:d||!y||!c,snapAngle:15,onRotateStart:()=>{g?.()},onRotate:z=>{i?.(z)},onRotateEnd:z=>{l(e.id,{rotation:z}),b?.(z)}}),V=s.useMemo(()=>L&&$.currentAngle!==null?$.currentAngle:e.rotation??0,[L,$.currentAngle,e.rotation]),p=s.useMemo(()=>B&&P.currentBounds?P.currentBounds:C?{x:e.x+M.delta.x,y:e.y+M.delta.y,width:e.width,height:e.height}:{x:e.x,y:e.y,width:e.width,height:e.height},[B,P.currentBounds,C,M.delta,e.x,e.y,e.width,e.height]),R=s.useMemo(()=>!B||!P.currentBounds?{x:1,y:1}:{x:P.currentBounds.width/e.width,y:P.currentBounds.height/e.height},[B,P.currentBounds,e.width,e.height]),O=s.useMemo(()=>!y||!a||d?[]:Xe({x:0,y:0,width:p.width,height:p.height},me),[y,a,d,p.width,p.height]),U=s.useCallback((z,D)=>{A(z,{x:e.x,y:e.y,width:e.width,height:e.height},D)},[A,e]),Y=s.useCallback(z=>{const D=p.x+p.width/2,I=p.y+p.height/2;H({x:D,y:I},e.rotation??0,z)},[H,p,e.rotation]),ne=s.useCallback(z=>{k.onClick(z),y&&T.onMouseDown(z)},[k,T,y]),K={cursor:C?"grabbing":y?"grab":"pointer",opacity:e.visible===!1?.5:1,...r};return s.createElement("g",{ref:E,className:de("canvas-element",n,{"canvas-element--selected":y,"canvas-element--dragging":C,"canvas-element--resizing":B,"canvas-element--rotating":L,"canvas-element--locked":e.locked}),transform:`translate(${p.x}, ${p.y})${V?` rotate(${V}, ${p.width/2}, ${p.height/2})`:""}`,style:K,onMouseDown:ne,onTouchStart:T.onTouchStart,"data-element-id":e.id,"data-element-type":e.type},B?s.createElement("g",{transform:`scale(${R.x}, ${R.y})`},t):t,y&&s.createElement("rect",{className:"canvas-element__selection",x:-2,y:-2,width:p.width+4,height:p.height+4,fill:"none",stroke:S.colors.selection.stroke,strokeWidth:1,strokeDasharray:"4 2",pointerEvents:"none"}),O.map(z=>s.createElement("rect",{key:z.position,className:`canvas-element__handle canvas-element__handle--${z.position}`,x:z.x,y:z.y,width:me,height:me,fill:S.colors.handle.fill,stroke:S.colors.handle.stroke,strokeWidth:1,cursor:Xt(z.position),onMouseDown:D=>U(z.position,D)})),y&&a&&c&&!d&&s.createElement("g",{key:"rotation-handle",className:"canvas-element__rotation-handle"},s.createElement("line",{x1:p.width/2,y1:0,x2:p.width/2,y2:-25,stroke:S.colors.selection.stroke,strokeWidth:1,pointerEvents:"none"}),s.createElement("circle",{cx:p.width/2,cy:-25,r:me/2+2,fill:S.colors.handle.fill,stroke:S.colors.handle.stroke,strokeWidth:1,cursor:"grab",onMouseDown:Y})))});ge.displayName="ElementBase";function Xt(e){return{nw:"nwse-resize",n:"ns-resize",ne:"nesw-resize",e:"ew-resize",se:"nwse-resize",s:"ns-resize",sw:"nesw-resize",w:"ew-resize"}[e]}function re(e){const t=s.forwardRef((n,r)=>{const o=n,a=o.element,c=o.disabled,u=o.showHandles,m=o.enableRotation,f=o.onSelect,h=o.onDragStart,v=o.onDrag,w=o.onDragEnd,x=o.onResizeStart,g=o.onResize,i=o.onResizeEnd,b=o.onRotateStart,E=o.onRotate,l=o.onRotateEnd,S=o.className,d=o.style,{element:y,disabled:k,showHandles:C,enableRotation:M,onSelect:T,onDragStart:B,onDrag:P,onDragEnd:A,onResizeStart:L,onResize:$,onResizeEnd:H,onRotateStart:V,onRotate:p,onRotateEnd:R,className:O,style:U,...Y}=o,[ne,K]=s.useState({isSelected:!1,isDragging:!1,isResizing:!1,isRotating:!1}),z=s.useCallback(_=>{K(j=>({...j,isSelected:_})),f?.(_)},[f]),D=s.useCallback(()=>{K(_=>({..._,isDragging:!0})),h?.()},[h]),I=s.useCallback((_,j)=>{K(J=>({...J,isDragging:!1})),w?.(_,j)},[w]),N=s.useCallback(()=>{K(_=>({..._,isResizing:!0})),x?.()},[x]),W=s.useCallback((_,j,J,Q)=>{K(F=>({...F,isResizing:!1})),i?.(_,j,J,Q)},[i]),Z=s.useCallback(()=>{K(_=>({..._,isRotating:!0})),b?.()},[b]),G=s.useCallback(_=>{K(j=>({...j,isRotating:!1})),l?.(_)},[l]),X={element:a,...ne};return ee.jsx(ge,{ref:r,element:a,disabled:c,showHandles:u,enableRotation:m,className:S,style:d,onSelect:z,onDragStart:D,onDrag:v,onDragEnd:I,onResizeStart:N,onResize:g,onResizeEnd:W,onRotateStart:Z,onRotate:E,onRotateEnd:G,children:ee.jsx(e,{...X,...Y})})});return t.displayName=`withElementBehavior(${e.displayName||e.name||"Component"})`,t}const Yt=({element:e})=>{const{theme:t}=q(),{width:n,height:r,style:o}=e;return s.createElement("rect",{width:n,height:r,fill:o?.fill??t.colors.element.fill,stroke:o?.stroke??t.colors.element.stroke,strokeWidth:o?.strokeWidth??t.strokeWidth.normal,rx:o?.cornerRadius??0,ry:o?.cornerRadius??0,opacity:o?.opacity??1})},pe=re(Yt);pe.displayName="Rectangle";const Kt=({element:e})=>{const{theme:t}=q(),{width:n,height:r,style:o}=e,a=n/2,c=r/2,u=n/2,m=r/2;return s.createElement("ellipse",{cx:a,cy:c,rx:u,ry:m,fill:o?.fill??t.colors.element.fill,stroke:o?.stroke??t.colors.element.stroke,strokeWidth:o?.strokeWidth??t.strokeWidth.normal,opacity:o?.opacity??1})},ie=re(Kt);ie.displayName="Ellipse";const ft=ie;ft.displayName="Circle";const xt=ie;xt.displayName="Oval";const Gt=({element:e})=>{const{theme:t}=q(),{width:n,height:r,style:o}=e,a=[`${n/2},0`,`${n},${r/2}`,`${n/2},${r}`,`0,${r/2}`].join(" ");return s.createElement("polygon",{points:a,fill:o?.fill??t.colors.element.fill,stroke:o?.stroke??t.colors.element.stroke,strokeWidth:o?.strokeWidth??t.strokeWidth.normal,opacity:o?.opacity??1})},Ce=re(Gt);Ce.displayName="Diamond";const Re=s.forwardRef(({element:e,disabled:t,showHandles:n,enableRotation:r,onSelect:o,onDragStart:a,onDrag:c,onDragEnd:u,onResizeStart:m,onResize:f,onResizeEnd:h,onRotateStart:v,onRotate:w,onRotateEnd:x,onTextChange:g,className:i,style:b},E)=>{const{theme:l}=q(),{updateElement:S}=ce(),[d,y]=s.useState(!1),[k,C]=s.useState(e.text??""),M=s.useRef(null),{width:T,height:B,style:P,text:A="",fontSize:L,fontFamily:$,fontWeight:H,textAlign:V}=e,p=s.useCallback(D=>{const I=document.createElementNS("http://www.w3.org/2000/svg","svg");I.style.position="absolute",I.style.visibility="hidden",I.style.pointerEvents="none",document.body.appendChild(I);const N=document.createElementNS("http://www.w3.org/2000/svg","text");N.setAttribute("font-size",String(L??l.fontSize.md)),N.setAttribute("font-family",$??"sans-serif"),N.setAttribute("font-weight",H??"normal");const W=D.split(`
`),Z=(L??l.fontSize.md)*1.2;let G=0;W.forEach((J,Q)=>{const F=document.createElementNS("http://www.w3.org/2000/svg","tspan");F.textContent=J||" ",F.setAttribute("x","0"),F.setAttribute("dy",Q===0?"0":String(Z)),N.appendChild(F)}),I.appendChild(N),G=N.getBBox().width;const _=W.length*Z;document.body.removeChild(I);const j=16;return{width:Math.max(G+j,40),height:Math.max(_+j,24)}},[L,$,H,l.fontSize.md]),R=s.useCallback(()=>{switch(V){case"right":return"end";case"center":return"middle";default:return"start"}},[V]),O=s.useCallback(()=>{switch(V){case"right":return T;case"center":return T/2;default:return 0}},[V,T]),U=s.useCallback(D=>{e.locked||t||(D.stopPropagation(),D.preventDefault(),C(A),y(!0))},[e.locked,t,A]),Y=s.useCallback(()=>{const D=k.trim();if(D!==A||D!==""){const I=p(D);S(e.id,{text:D,width:I.width,height:I.height}),g?.(D)}y(!1)},[k,A,p,S,e.id,g]),ne=s.useCallback(()=>{C(A),y(!1)},[A]),K=s.useCallback(D=>{D.key==="Escape"?(D.preventDefault(),ne()):D.key==="Enter"&&!D.shiftKey&&(D.preventDefault(),Y()),D.stopPropagation()},[ne,Y]);s.useEffect(()=>{d&&M.current&&(M.current.focus(),M.current.select())},[d]);const z=()=>d?s.createElement("foreignObject",{x:0,y:0,width:T,height:B},s.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:V==="center"?"center":V==="right"?"flex-end":"flex-start"}},s.createElement("textarea",{ref:M,value:k,onChange:D=>C(D.target.value),onBlur:Y,onKeyDown:K,style:{width:"100%",height:"100%",padding:"4px",border:`2px solid ${l.colors.selection.stroke}`,borderRadius:"2px",outline:"none",resize:"none",backgroundColor:l.colors.background,color:P?.fill??l.colors.text.primary,fontSize:L??l.fontSize.md,fontFamily:$??"sans-serif",fontWeight:H??"normal",textAlign:V??"left",boxSizing:"border-box"}}))):s.createElement("g",{onDoubleClick:U},s.createElement("rect",{width:T,height:B,fill:"transparent"}),s.createElement("text",{x:O(),y:B/2,dominantBaseline:"central",textAnchor:R(),fill:P?.fill??l.colors.text.primary,fontSize:L??l.fontSize.md,fontFamily:$??"sans-serif",fontWeight:H??"normal",opacity:P?.opacity??1,style:{pointerEvents:"none"}},A));return s.createElement(ge,{ref:E,element:e,children:z(),disabled:t||d,showHandles:n&&!d,enableRotation:r,className:i,style:b,onSelect:o,onDragStart:a,onDrag:c,onDragEnd:u,onResizeStart:m,onResize:f,onResizeEnd:h,onRotateStart:v,onRotate:w,onRotateEnd:x})});Re.displayName="TextElement";const je=8,He=25,Et=s.forwardRef(({element:e,children:t,renderLine:n,className:r,style:o,disabled:a=!1,showHandles:c=!0,enableRotation:u=!0,onSelect:m,onDragStart:f,onDrag:h,onDragEnd:v,onPointsChange:w,onRotateStart:x,onRotate:g,onRotateEnd:i},b)=>{const{updateElement:E}=ce(),{theme:l}=q(),{screenToCanvas:S}=ae(),d=e.locked||a,[y,k]=s.useState({isDragging:!1,endpointIndex:null,startPosition:null,currentPoints:null}),C=s.useRef(null),M=s.useMemo(()=>e.points??[{x:0,y:e.height/2},{x:e.width,y:e.height/2}],[e.points,e.width,e.height]),{isSelected:T,handlers:B}=Se({id:e.id,disabled:d,onSelect:m}),{isDragging:P,dragState:A,handlers:L}=ke({disabled:d||!T||y.isDragging,onDragStart:()=>{f?.()},onDrag:(I,N)=>{const W=e.x+N.x,Z=e.y+N.y;h?.(W,Z)},onDragEnd:(I,N)=>{const W=e.x+N.x,Z=e.y+N.y;E(e.id,{x:W,y:Z}),v?.(W,Z)}}),{isRotating:$,rotateState:H,startRotate:V}=be({disabled:d||!T||!u,snapAngle:15,onRotateStart:()=>{x?.()},onRotate:I=>{g?.(I)},onRotateEnd:I=>{E(e.id,{rotation:I}),i?.(I)}}),p=s.useMemo(()=>$&&H.currentAngle!==null?H.currentAngle:e.rotation??0,[$,H.currentAngle,e.rotation]),R=s.useMemo(()=>P?{x:e.x+A.delta.x,y:e.y+A.delta.y,width:e.width,height:e.height}:{x:e.x,y:e.y,width:e.width,height:e.height},[P,A.delta,e.x,e.y,e.width,e.height]),O=s.useMemo(()=>y.isDragging&&y.currentPoints?y.currentPoints:M,[y.isDragging,y.currentPoints,M]),U=s.useCallback((I,N)=>{if(d||!T)return;N.stopPropagation(),N.preventDefault();const W=S({x:N.clientX,y:N.clientY});C.current={endpointIndex:I,startMousePos:W,originalPoints:[...M]},k({isDragging:!0,endpointIndex:I,startPosition:W,currentPoints:[...M]});const Z=X=>{if(!C.current)return;const _=S({x:X.clientX,y:X.clientY}),{endpointIndex:j,startMousePos:J,originalPoints:Q}=C.current,F=_.x-J.x,fe=_.y-J.y,xe=Q.map((se,Ee)=>Ee===j?{x:se.x+F,y:se.y+fe}:{...se});k(se=>({...se,currentPoints:xe}))},G=()=>{C.current&&(C.current,k(X=>{if(X.currentPoints){const _=X.currentPoints,j=_.map(le=>le.x),J=_.map(le=>le.y),Q=Math.min(...j),F=Math.min(...J),fe=Math.max(...j),xe=Math.max(...J),se=_.map(le=>({x:le.x-Q,y:le.y-F})),Ee=Math.max(fe-Q,1),bt=Math.max(xe-F,1);E(e.id,{x:e.x+Q,y:e.y+F,width:Ee,height:bt,points:se}),w?.(se)}return{isDragging:!1,endpointIndex:null,startPosition:null,currentPoints:null}}),C.current=null,document.removeEventListener("mousemove",Z),document.removeEventListener("mouseup",G))};document.addEventListener("mousemove",Z),document.addEventListener("mouseup",G)},[d,T,M,S,E,e.id,e.x,e.y,w]),Y=s.useCallback(I=>{const N=O[0],W=O[O.length-1],Z=(N.x+W.x)/2,G=(N.y+W.y)/2,X=R.x+Z,_=R.y+G;V({x:X,y:_},e.rotation??0,I)},[V,R,O,e.rotation]),ne=s.useCallback(I=>{B.onClick(I),T&&!y.isDragging&&L.onMouseDown(I)},[B,L,T,y.isDragging]),K={cursor:P?"grabbing":T?"grab":"pointer",opacity:e.visible===!1?.5:1,...o},z=s.useMemo(()=>O.map(I=>({x:I.x,y:I.y})),[O]),D=s.useMemo(()=>{if(O.length<2)return{cx:0,cy:0,x1:0,y1:0,x2:0,y2:0};const I=O[0],N=O[O.length-1],W=(I.x+N.x)/2,Z=(I.y+N.y)/2,G=N.x-I.x,X=N.y-I.y,_=Math.sqrt(G*G+X*X)||1,j=-X/_,J=G/_,Q=W+j*He,F=Z+J*He;return{cx:Q,cy:F,x1:W,y1:Z,x2:Q,y2:F}},[O]);return s.createElement("g",{ref:b,className:de("canvas-element canvas-line",r,{"canvas-element--selected":T,"canvas-element--dragging":P,"canvas-element--endpoint-dragging":y.isDragging,"canvas-element--rotating":$,"canvas-element--locked":e.locked}),transform:`translate(${R.x}, ${R.y})${p?` rotate(${p}, ${R.width/2}, ${R.height/2})`:""}`,style:K,onMouseDown:ne,onTouchStart:L.onTouchStart,"data-element-id":e.id,"data-element-type":e.type},n(O,y.isDragging),T&&c&&!d&&z.map((I,N)=>s.createElement("circle",{key:`endpoint-handle-${N}`,className:"canvas-line__endpoint-handle",cx:I.x,cy:I.y,r:je/2+2,fill:l.colors.handle.fill,stroke:l.colors.handle.stroke,strokeWidth:1.5,cursor:"move",onMouseDown:W=>U(N,W)})),T&&c&&u&&!d&&s.createElement("g",{key:"rotation-handle",className:"canvas-line__rotation-handle"},s.createElement("line",{x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,stroke:l.colors.selection.stroke,strokeWidth:1,pointerEvents:"none"}),s.createElement("circle",{cx:D.cx,cy:D.cy,r:je/2+2,fill:l.colors.handle.fill,stroke:l.colors.handle.stroke,strokeWidth:1,cursor:"grab",onMouseDown:Y})))});Et.displayName="LineBase";const Ie=s.forwardRef(({element:e,disabled:t,showHandles:n,enableRotation:r,onSelect:o,onDragStart:a,onDrag:c,onDragEnd:u,onPointsChange:m,onRotateStart:f,onRotate:h,onRotateEnd:v,className:w,style:x},g)=>{const{theme:i}=q(),{style:b,lineType:E="solid"}=e,l=s.useCallback(()=>{switch(E){case"dashed":return"8 4";case"dotted":return"2 2";default:return}},[E]),S=b?.stroke??i.colors.element.stroke,d=b?.strokeWidth??i.strokeWidth.normal,y=s.useCallback((k,C)=>{const M=k.map((T,B)=>B===0?`M ${T.x} ${T.y}`:`L ${T.x} ${T.y}`).join(" ");return s.createElement("g",null,s.createElement("path",{d:M,fill:"none",stroke:"transparent",strokeWidth:20,strokeLinecap:"round"}),s.createElement("path",{d:M,fill:"none",stroke:S,strokeWidth:d,strokeDasharray:l(),strokeLinecap:"round",strokeLinejoin:"round",opacity:b?.opacity??1}))},[S,d,l,b?.opacity]);return s.createElement(Et,{ref:g,element:e,disabled:t,showHandles:n,enableRotation:r,className:w,style:x,onSelect:o,onDragStart:a,onDrag:c,onDragEnd:u,onPointsChange:m,onRotateStart:f,onRotate:h,onRotateEnd:v,renderLine:y})});Ie.displayName="Line";const Jt=({element:e})=>{const{theme:t}=q(),{width:n,height:r,style:o,label:a}=e,c=Math.min(n,r)*.15,u=n/2,m=c*2+4,f=r*.6,h=m+(f-m)*.3,v=n*.4,w=n*.35,x=r-4,g=o?.stroke??t.colors.element.stroke,i=o?.strokeWidth??t.strokeWidth.normal;return s.createElement("g",null,s.createElement("rect",{width:n,height:r,fill:"transparent"}),s.createElement("circle",{cx:u,cy:c+2,r:c,fill:o?.fill??"none",stroke:g,strokeWidth:i}),s.createElement("line",{x1:u,y1:m,x2:u,y2:f,stroke:g,strokeWidth:i}),s.createElement("line",{x1:u-v,y1:h,x2:u+v,y2:h,stroke:g,strokeWidth:i}),s.createElement("line",{x1:u,y1:f,x2:u-w,y2:r*.85,stroke:g,strokeWidth:i}),s.createElement("line",{x1:u,y1:f,x2:u+w,y2:r*.85,stroke:g,strokeWidth:i}),a&&s.createElement("text",{x:u,y:x,textAnchor:"middle",dominantBaseline:"text-bottom",fill:o?.fill??t.colors.text.primary,fontSize:t.fontSize.sm,fontFamily:"sans-serif"},a))},Te=re(Jt);Te.displayName="Actor";const qt=({element:e})=>{const{theme:t}=q(),{width:n,height:r,style:o,label:a}=e,c=n/2,u=40,m=o?.stroke??t.colors.element.stroke,f=o?.strokeWidth??t.strokeWidth.normal;return s.createElement("g",null,s.createElement("rect",{x:0,y:0,width:n,height:u,fill:o?.fill??t.colors.element.fill,stroke:m,strokeWidth:f}),a&&s.createElement("text",{x:c,y:u/2,textAnchor:"middle",dominantBaseline:"central",fill:t.colors.text.primary,fontSize:t.fontSize.sm,fontFamily:"sans-serif"},a),s.createElement("line",{x1:c,y1:u,x2:c,y2:r,stroke:m,strokeWidth:f,strokeDasharray:"8 4"}))},Me=re(qt);Me.displayName="Lifeline";const Qt=({element:e})=>{const{theme:t}=q(),{width:n,height:r,style:o,label:a,messageType:c="sync"}=e,u=o?.stroke??t.colors.connection.line,m=o?.strokeWidth??t.strokeWidth.normal,f=10,h=r/2,v=()=>{switch(c){case"return":return"8 4";case"create":return"4 2";default:return}},w=()=>c==="async"?s.createElement("polyline",{points:`${n-f},${h-f/2} ${n},${h} ${n-f},${h+f/2}`,fill:"none",stroke:u,strokeWidth:m}):s.createElement("polygon",{points:`${n},${h} ${n-f},${h-f/2} ${n-f},${h+f/2}`,fill:u,stroke:u,strokeWidth:1});return s.createElement("g",null,s.createElement("rect",{width:n,height:r,fill:"transparent"}),s.createElement("line",{x1:0,y1:h,x2:n-(c==="async"?0:f/2),y2:h,stroke:u,strokeWidth:m,strokeDasharray:v()}),w(),a&&s.createElement("text",{x:n/2,y:h-8,textAnchor:"middle",dominantBaseline:"text-bottom",fill:t.colors.text.primary,fontSize:t.fontSize.sm,fontFamily:"sans-serif"},a))},ze=re(Qt);ze.displayName="Message";const en=({element:e})=>{const{theme:t}=q(),{width:n,height:r,style:o}=e;return s.createElement("rect",{width:n||12,height:r,fill:o?.fill??t.colors.element.fill,stroke:o?.stroke??t.colors.element.stroke,strokeWidth:o?.strokeWidth??t.strokeWidth.normal})},De=re(en);De.displayName="ActivationBar";const Ve={rectangle:pe,ellipse:ie,circle:ie,diamond:Ce,text:Re,line:Ie,actor:Te,lifeline:Me,message:ze,activationBar:De,custom:pe},Ne=s.forwardRef(({width:e,height:t,className:n,style:r,showGrid:o,gridSize:a,onCanvasClick:c,onCanvasDoubleClick:u,children:m},f)=>{const{elements:h,config:v}=ce(),{clearSelection:w}=he(),{viewport:x}=ae(),{theme:g}=q(),i=e??v.width,b=t??v.height,E=o??v.grid?.visible,l=a??v.grid?.size??20,S=s.useMemo(()=>ye(h),[h]),d=s.useCallback(M=>{w(),c?.(M)},[w,c]),y=()=>{if(!E)return null;const M="canvas-grid-pattern";return s.createElement(s.Fragment,null,s.createElement("defs",null,s.createElement("pattern",{id:M,width:l,height:l,patternUnits:"userSpaceOnUse"},s.createElement("path",{d:`M ${l} 0 L 0 0 0 ${l}`,fill:"none",stroke:g.colors.grid.line,strokeWidth:.5}))),s.createElement("rect",{width:"100%",height:"100%",fill:`url(#${M})`,pointerEvents:"none"}))},k=()=>s.createElement("rect",{className:"canvas-background",width:"100%",height:"100%",fill:"transparent",onMouseDown:d}),C=M=>{const T=Ve[M.type]??Ve.custom;return s.createElement(T,{key:M.id,element:M})};return s.createElement("svg",{ref:f,className:de("canvas-drawing",n),width:i,height:b,viewBox:`0 0 ${i} ${b}`,style:{backgroundColor:g.colors.background,cursor:"default",userSelect:"none",...r},onDoubleClick:u},s.createElement("g",{transform:`translate(${x.pan.x}, ${x.pan.y}) scale(${x.zoom})`},k(),y(),S.map(C),m))});Ne.displayName="DrawingCanvas";const vt=s.forwardRef(({width:e,height:t,readonly:n=!1,showGrid:r,gridSize:o,enableKeyboardShortcuts:a=!0,className:c,style:u,children:m},f)=>{const h=s.useRef(null),v=ce(),w=he(),x=ae(),g=gt();return yt(a?{undo:g.undo,redo:g.redo,delete:g.removeSelected,selectAll:()=>w.selectAll(v.elements.map(i=>i.id)),copy:g.copy,paste:g.paste,cut:g.cut,escape:w.clearSelection,zoomIn:x.zoomIn,zoomOut:x.zoomOut,resetZoom:x.resetViewport}:{}),s.useImperativeHandle(f,()=>({addElement:g.addElement,updateElement:g.updateElement,removeElement:g.removeElement,getElement:v.getElementById,getElementsByType:v.getElementsByType,select:w.select,selectMultiple:w.selectMultiple,clearSelection:w.clearSelection,getSelectedIds:()=>w.selectedIds,zoomIn:x.zoomIn,zoomOut:x.zoomOut,setZoom:x.setZoom,resetViewport:x.resetViewport,undo:g.undo,redo:g.redo,canUndo:g.canUndo,canRedo:g.canRedo,toJSON:()=>({elements:v.elements,connections:v.connections}),toSVG:()=>h.current?.outerHTML??"",toImage:async i=>{if(!h.current)throw new Error("SVG element not available");return we(h.current,i)},fromJSON:i=>{const b=Je(i);return v.setElements(b.elements),v.setConnections(b.connections),w.clearSelection(),b}}),[v,w,x,g]),ee.jsxs("div",{className:de("canvas-container",c,{"canvas-container--readonly":n}),style:{position:"relative",overflow:"hidden",...u},tabIndex:0,children:[ee.jsx(Ne,{ref:h,width:e,height:t,showGrid:r,gridSize:o}),m]})});vt.displayName="CanvasInner";const wt=s.forwardRef(({elements:e,connections:t,selectedIds:n,defaultElements:r=[],defaultConnections:o=[],config:a,theme:c="light",initialViewport:u,maxHistorySize:m,onChange:f,onSelectionChange:h,...v},w)=>ee.jsx(ht,{initialElements:r,initialConnections:o,elements:e,connections:t,selectedIds:n,config:a,theme:c,initialViewport:u,maxHistorySize:m,onElementsChange:f,onSelectionChange:h,children:ee.jsx(vt,{...v,ref:w})}));wt.displayName="Canvas";const Fe={rectangle:{width:120,height:80},ellipse:{width:120,height:80},circle:{width:80,height:80},diamond:{width:100,height:100},text:{width:100,height:30},line:{width:100,height:2},actor:{width:60,height:100},lifeline:{width:100,height:300},message:{width:150,height:30},activationBar:{width:12,height:60},custom:{width:100,height:100}},te=(e,t={})=>{const n=Fe[e]??Fe.custom;return{id:t.id??ue(),type:e,x:t.x??0,y:t.y??0,width:t.width??n.width,height:t.height??n.height,zIndex:t.zIndex??0,style:t.style,locked:t.locked??!1,visible:t.visible??!0,data:t.data}},Ae=(e={})=>te("rectangle",e),Le=(e={})=>te("ellipse",e),Oe=(e={})=>{const t=e.width??e.height??80;return te("circle",{...e,width:t,height:t})},_e=(e={})=>te("diamond",e),Pe=(e={})=>{const{text:t,fontSize:n,fontFamily:r,fontWeight:o,textAlign:a,...c}=e;return{...te("text",c),type:"text",text:t??"",fontSize:n,fontFamily:r,fontWeight:o,textAlign:a}},Be=(e={})=>{const{points:t,lineType:n,x:r,y:o,...a}=e,c=a.width??100;let u=t??[{x:r??0,y:o??0},{x:(r??0)+c,y:o??0}];const m=u.map(d=>d.x),f=u.map(d=>d.y),h=Math.min(...m),v=Math.min(...f),w=Math.max(...m),x=Math.max(...f),g=u.map(d=>({x:d.x-h,y:d.y-v})),i=w-h,b=x-v,E=Math.max(i,10),l=Math.max(b,10),S=g.map(d=>({x:i<10?d.x+(10-i)/2:d.x,y:b<10?d.y+(10-b)/2:d.y}));return{...te("line",{...a,x:i<10?h-(10-i)/2:h,y:b<10?v-(10-b)/2:v,width:E,height:l}),type:"line",points:S,lineType:n??"solid"}},$e=(e={})=>{const{label:t,...n}=e;return{...te("actor",n),type:"actor",label:t}},We=(e={})=>{const{label:t,...n}=e;return{...te("lifeline",n),type:"lifeline",label:t}},Ue=(e={})=>{const{label:t,messageType:n,fromId:r,toId:o,...a}=e;return{...te("message",a),type:"message",label:t,messageType:n??"sync",fromId:r,toId:o}},Ze=(e={})=>te("activationBar",e),kt=(e,t={})=>{switch(e){case"rectangle":return Ae(t);case"ellipse":return Le(t);case"circle":return Oe(t);case"diamond":return _e(t);case"text":return Pe(t);case"line":return Be(t);case"actor":return $e(t);case"lifeline":return We(t);case"message":return Ue(t);case"activationBar":return Ze(t);default:return te(e,t)}},tn={create:kt,rectangle:Ae,ellipse:Le,circle:Oe,diamond:_e,text:Pe,line:Be,actor:$e,lifeline:We,message:Ue,activationBar:Ze};exports.ActivationBar=De;exports.Actor=Te;exports.Canvas=wt;exports.CanvasProvider=ut;exports.Circle=ft;exports.CombinedCanvasProvider=ht;exports.Diamond=Ce;exports.DrawingCanvas=Ne;exports.ElementBase=ge;exports.ElementFactory=tn;exports.Ellipse=ie;exports.HistoryProvider=it;exports.Lifeline=Me;exports.Line=Ie;exports.Message=ze;exports.Oval=xt;exports.Rectangle=pe;exports.SelectionProvider=at;exports.TextElement=Re;exports.ThemeProvider=tt;exports.ViewportProvider=ot;exports.boundsIntersect=Rt;exports.bringToFront=Ye;exports.createActivationBar=Ze;exports.createActor=$e;exports.createCircle=Oe;exports.createDiamond=_e;exports.createElement=kt;exports.createEllipse=Le;exports.createLifeline=We;exports.createLine=Be;exports.createMessage=Ue;exports.createRectangle=Ae;exports.createText=Pe;exports.cx=de;exports.darkTheme=Qe;exports.deepMerge=ve;exports.deserializeFromJSON=Je;exports.distance=St;exports.downloadAsFile=Pt;exports.downloadAsImage=Bt;exports.exportToImage=we;exports.exportToSVG=_t;exports.generateId=ue;exports.getResizeHandles=Xe;exports.getThemeCSSVariables=$t;exports.isPointInBounds=Ct;exports.lightTheme=oe;exports.sendToBack=Ke;exports.serializeToJSON=Ot;exports.snapToGrid=It;exports.sortByZIndex=ye;exports.useCanvas=ce;exports.useCanvasActions=gt;exports.useCanvasKeyboardShortcuts=yt;exports.useDraggable=ke;exports.useHistory=lt;exports.useKeyboard=pt;exports.useResizable=mt;exports.useRotatable=be;exports.useSelectable=Se;exports.useSelection=he;exports.useTheme=q;exports.useViewport=ae;exports.validateCanvasData=Ge;exports.withElementBehavior=re;
//# sourceMappingURL=index.cjs.map
